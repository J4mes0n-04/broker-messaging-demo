sequenceDiagram
    participant Consumer as Kafka Consumer
    participant Kafka as Kafka Broker
    participant App as Application
    participant CommitMgr as Commit Manager

    Note over Consumer: subscribe(['orders'])
    Consumer->>Kafka: Subscribe to topic 'orders'
    Kafka-->>Consumer: Subscription confirmed

    loop Poll messages continuously
        Consumer->>Kafka: poll(timeout=1.0)
        Note over Kafka: Wait for message (1 second)
        
        alt Message available
            Kafka-->>Consumer: msg received
            Consumer->>App: Deserialize message (json.loads)
            App->>App: Process order
            Note over App: Extract order details
            
            Consumer->>CommitMgr: commit(message=msg)
            CommitMgr->>Kafka: Commit offset
            Kafka-->>CommitMgr: Offset committed
            CommitMgr-->>Consumer: Commit confirmed
            
        else Timeout (no message)
            Kafka-->>Consumer: None (timeout)
            Consumer->>Consumer: Continue polling
        end
    end

    Consumer->>Kafka: close()
    Note over Consumer: Graceful shutdown
