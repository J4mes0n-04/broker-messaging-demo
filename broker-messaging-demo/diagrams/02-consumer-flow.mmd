sequenceDiagram
    participant Consumer as Consumer
    participant Kafka as Kafka 
    participant App as Приложение
    participant CommitMgr as Менеджер Commit
    
    Consumer->>Kafka: Подписка на topic 'orders'
    Kafka-->>Consumer: Подписка подтверждена

    loop Непрерывный опрос сообщений
        Consumer->>Kafka: poll(timeout=1.0)
        
        alt Сообщение получено
            Kafka-->>Consumer: Сообщение получено
            Consumer->>App: Десериализация (json.loads)
            App->>App: Обработка заказа

            
            Consumer->>CommitMgr: commit(message=msg)
            CommitMgr->>Kafka: Commit смещения
            Kafka-->>CommitMgr: Смещение зафиксировано
            CommitMgr-->>Consumer: Commit подтвержден
            
        else Timeout (нет сообщения)
            Kafka-->>Consumer: None (timeout)
            Consumer->>Consumer: Продолжить опрос
        end
    end

    Consumer->>Kafka: close()
    Note over Consumer: Завершение